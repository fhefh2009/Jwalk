/*
	Description : Jwalk - JavaScript Animation Library
	Version ： V1.0
	Author : ok8008@yeah.net
	Link : http://liutian1937.github.io/Jwalk/
*/
(function(){var l=(function(){var f=document.documentElement.style,g={};function h(b,c){var a=0,d=b.length;for(;a<d;a+=1){c(b[a])}};var i=(function(){var c=['t','webkitT','MozT','msT','OT'],a,d;h(c,function(b){a=b+'ransform';if(a in f){d=b.substr(0,b.length-1)}});return d})();g.extend=function(b,c){for(var a in c){b[a]=c[a]}};function e(b){if(i==='')return b;if(!i)return false;return i+b.charAt(0).toUpperCase()+b.substr(1)};g.extend(g,{css3:e('transition'),Transform:e('transform'),Property:e('transitionProperty'),Duration:e('transitionDuration'),TimingFunction:e('transitionTimingFunction')});return g})();var m=function(b,c){c=c||null;if(!(this instanceof m)){return new m(b,c)};this.elem=b||{};this.options={openProcess:false,speeds:{normal:400,fast:200,slow:600},easing:'linear',em2px:16,interval:0};if(c&&typeof c=='object'){for(var a in c){if(this.options.hasOwnProperty(a)){this.options[a]=c[a]}}};this.init();this._8()};m.prototype={init:function(){var b=this;this.isAnimate=false;this.data={};this.beginStyle={};this.finalStyle=null;this.played=true;return this},animate:function(){var a=this,d=arguments,f=d.length,g={};if(typeof d[0]==='object'){g.style=d[0]}else{return false};g.callback=(function(){return function(b,c){if(d[f-1]&&typeof d[f-1]==='function'){d[f-1](b)};if(c&&typeof c==='function'){c()}}})();g.speed=(typeof d[1]==='number')?d[1]:(function(){return(typeof d[1]==='string'&&d[1]in a.options.speeds)?a.options.speeds[d[1]]:a.options.speeds['normal']})();g.speed=l.css3?g.speed:parseInt(g.speed/1.5);g.easing=(f>1)?(function(){return(d[2]&&typeof d[2]==='string')?d[2]:(function(){return(typeof d[1]==='string'&&!(d[1]in a.options.speeds))?d[1]:a.options.easing})()})():a.options.easing;g.startStyle={};g.endStyle={};g.pauseStyle={};g.remainderTime=g.speed;if(a.played){this.stepArray=[];this.newStepArray=null;a.played=false};a.stepArray.push(g);a.current=0;a.total=a.stepArray.length;return a},play:function(b){var c;if(this.isAnimate){return false};if(!this.newStepArray){this.newStepArray=this.stepArray.concat()};this.played=true;c=this.newStepArray[this.current];if(!b&&this.data.status==='pause'){this._5(c)}else{this._9(c,this.finalStyle)};this.stoped=false},pause:function(){var b,c=this.elem;if(!this.newStepArray||this.data.status==='pause'){return false};if(this.delayTimer&&this.data.status==='end'){this.stoped=true;return false};this.isAnimate=false;b=this.newStepArray[this.current];clearInterval(this.timer);if(b.remainderTime>0){if(l.css3){for(var a in b.startStyle){c.style[a]=this._0(c,a)}}else{this._a(b,b.endStyle)}};this.data.status='pause';b.callback(this.data)},stop:function(){this.stoped=true},step:function(){var b=0,c,a;if(arguments.length>1){this.stepActive=false;this.newStepArray=[];a=Array.prototype.slice.call(arguments,0);for(;b<a.length;b+=1){if(this.stepArray[a[b]]){this.newStepArray.push(this.stepArray[a[b]])}};this.total=this.newStepArray.length}else{this.stepActive=true;this.newStepArray=this.stepArray.concat();this.total=this.newStepArray.length;if(typeof arguments[0]==='number'&&arguments[0]<this.total){this.current=Math.ceil(arguments[0])}};return this},replay:function(){this._6();this.play(true)},reset:function(){if(this.isAnimate){return false};this._6();for(var b in this.elem.style){if(this.elem.style[b])this.elem.style[b]=this.beginStyle[b]}},cycle:function(b){this.stepActive=false;this.times=b||null;if(b&&typeof b==='number'){this.times=b-1}else{this.infinite=true}this.play()},extend:function(b){if(b&&typeof b==='object'){for(var c in b){if(!this.hasOwnProperty(c)){m.prototype[c]=b[c]}}}},_8:function(){var a=this;a.control=(function(){return{process:function(b){a.data.result={};for(var c in b.style){a.data.result[c]=a._0(a.elem,c)};a.data.status='process';b.callback(a.data)},end:function(b){a.isAnimate=false;if(a.stepActive){return false};(a.current<a.total-1)?(function(){a.current+=1;if(a.data.status!=='pause'){a.control.delay()}})():(function(){a.current=0;if(a.data.status!=='pause'){if(a.infinite||a.times){if(a.times){a.times-=1};a.control.delay()}}})()},delay:function(){if(a.options.interval){if(a.delayTimer){clearTimeout(a.delayTimer)};a.delayTimer=setTimeout(function(){if(a.stoped){return false};a.play();clearTimeout(a.delayTimer)},a.options.interval)}else{if(a.stoped){return false};a.play()}}}})();a.extend({width:function(){return a._2(a.elem,'width')+'px'},height:function(){return a._2(a.elem,'height')+'px'},toggle:function(){if(a.isAnimate){return false};(a._0(a.elem,'display')==='none')?a.show(arguments):a.hide(arguments)},hide:function(){var b=(arguments.length>0&&typeof arguments[0]!='function')?arguments[0]:'normal',c=(arguments.length>0)?arguments[arguments.length-1]:null;a._3({opacity:'0'},b,function(){a.elem.style.display='none';if(c&&typeof c==='function'){c()}})},show:function(){var b=(arguments.length>0&&typeof arguments[0]!='function')?arguments[0]:'normal',c=(arguments.length>0)?arguments[arguments.length-1]:null;a._4({'display':'block'});a._3({opacity:'1'},b,c)},slideToggle:function(){if(a.isAnimate){return false};(a._0(a.elem,'height')==='0px'||a._0(a.elem,'display')==='none')?a.slideDown(arguments):a.slideUp(arguments)},slideUp:function(){var b=(arguments.length>0&&typeof arguments[0]!='function')?arguments[0]:'normal',c=(arguments.length>0)?arguments[arguments.length-1]:null;a.tempHeight=a.tempHeight?a.tempHeight:a._2(a.elem,'height')+'px';a._3({height:'0px'},b,function(){a._4({'display':'none','height':a.tempHeight});if(c&&typeof c==='function'){c()}})},slideDown:function(){var b=(arguments.length>0&&typeof arguments[0]!='function')?arguments[0]:'normal',c=(arguments.length>0)?arguments[arguments.length-1]:null;a.tempHeight=a.tempHeight?a.tempHeight:a._2(a.elem,'height')+'px';a._4({'display':'block','overflow':'hidden','height':'0px'});a._3({height:a.tempHeight},b,c)}})},_3:function(c,a,d){var f=this;f.init();a=a||0;f.animate(c,a,function(b){if(b.status==='end'){if(d&&typeof d==='function'){d()}}}).play()},_6:function(){this.current=0;this.finalStyle=null;this.stepActive=false;this.infinite=false;this.data.status=''},_9:function(b,c){var a=this,d=b.style,f,g,h,i;if(l.css3){for(var e in d){if(c&&c[e]){f=c[e]}else{f=a._0(a.elem,e)};g=(d[e].match(/^\-=|\+=/))?(function(){return a._1(f)+a._1(d[e],e)+'px'})():d[e];if(!a.beginStyle[e]){if(e=='transform'){var j;e=l.Transform;j=a._0(a.elem,e);a.beginStyle['transform']=j;a.beginStyle[e]=j}else{a.beginStyle[e]=a._0(a.elem,e)}};b.startStyle[e]=f;b.endStyle[e]=g}}else{for(var e in d){if(e==='opacity'){if(c&&c[e]){f=c[e]}else{f=parseInt((a._0(a.elem,'filter')).replace(/[^0-9]/ig,""));f=(f||f===0)?f:100}processData=d[e]*100;h=true}else{i=a._0(a.elem,e);if(i){h=true;if(c&&c[e]){f=c[e]}else{i=(i=='auto')?(function(){if(e==='width'){return a.elem.offsetWidth}else if(e==='height'){return a.elem.offsetHeight}else{return'0px'}})():i;f=a._1(i)}processData=(Math.abs(parseInt(d[e].replace(/=|px|em/g,'')))>=0)?a._1(d[e],e):d[e]}else{h=false}};if(!a.beginStyle[e]){a.beginStyle[e]=a._0(a.elem,e)};if(h){g=(d[e].match(/^\-=|\+=/))?f+processData:processData;b.startStyle[e]=f;b.endStyle[e]=g}};b.pauseStyle=b.startStyle};this.finalStyle=b.endStyle;a.data.status='start';b.callback(a.data);b.remainderTime=b.speed;a._5(b)},_5:function(b){this.isAnimate=true;if(l.css3){this._b(b,b.remainderTime,b.easing);this._4(b.endStyle)}else{this._c(b,b.remainderTime,b.easing)};this.data.status='process'},_b:function(b,c,a){var d=this;d.elem.style[l.Property]='all';d.elem.style[l.Duration]=c+'ms';d.elem.style[l.TimingFunction]=a||d.options.easing;d.timer=setInterval(function(){d.isAnimate=true;b.remainderTime=(b.remainderTime>0)?b.remainderTime-20:0;if(d.options.openProcess){d.control.process(b)};if(b.remainderTime<=0){clearInterval(d.timer);d.data.status='end';b.callback(d.data,function(){d.control.end(b)})}},20)},_4:function(b){for(var c in b){c=(c=='transform')?l.Transform:c;if(c in this.elem.style){this.elem.style[c]=b[c]}}},_a:function(b,c){var a=this,d;for(var f in c){if(f==='opacity'){d=parseInt((a._0(a.elem,'filter')).replace(/[^0-9]/ig,""))||100}else{d=a._1(a._0(a.elem,f))}b.pauseStyle[f]=d}},_c:function(a,d,f){var g=this,h=0,i=parseInt(d/10),e=g.elem.style,j=a.pauseStyle,k=a.endStyle,n=(o[f])?o[f]:o[g.options.easing];function p(){if(h<i){h++;g.isAnimate=true;for(var b in j){if(typeof k[b]==='number'){if(b==='opacity'){e['filter']='alpha(opacity='+Math.ceil(n(h,j[b],k[b]-j[b],i))+')'}else{e[b]=Math.ceil(n(h,j[b],k[b]-j[b],i))+'px'}}else if(typeof j[b]==='string'&&typeof k[b]==='string'&&j[b].match(/\%/)&&k[b].match(/\%/)){e[b]=Math.ceil(n(h,parseInt(j[b]),parseInt(k[b])-parseInt(j[b]),i))+'%'}};if(g.options.openProcess){g.control.process(a)}}else{for(var c in k){if(typeof k[b]==='number'){if(b==='opacity'){e['filter']='alpha(opacity='+k['opacity']+')'}else{e[c]=k[c]+'px'}}else{e[c]=k[c]}};clearInterval(g.timer);g.data.status='end';a.callback(g.data);g.control.end(a)};a.remainderTime=(a.remainderTime>0)?a.remainderTime-10:0};g.timer=setInterval(p,10)},_0:function(b,c){return(b.currentStyle?b.currentStyle:window.getComputedStyle(b,null))[c]},_2:function(b,c){var a=this,d=c==='width'?'offsetWidth':'offsetHeight',f,g;f=a._0(b,c);return(f==='0px'||f==='auto')?(function(){if(a._0(b,'display')==='none'){b.style.display='block';b.style.height='auto';g=b[d]-a._7(c);b.style.display='none'}else{g=b[d]-a._7(c)}return g})():parseInt(f)},_7:function(b){var c=['Top','Right','Bottom','Left'],a=b==='width'?1:0,d=0,f=this,g,h;for(;a<4;a+=2){g=f._0(f.elem,'padding'+c[a]);h=f._0(f.elem,'border'+c[a]+'Width');if(g&&parseFloat(g)>0){d+=f._1(g)};if(h&&parseFloat(h)>0){d+=f._1(h)}};return d},_1:function(b,c){var a=this;b=b.replace(/=/g,'');if(b.match(/\%/)){if(c){c=c.toLowerCase();if(c.match(/left|right|width/)){var d=parseInt(a.elem.parentNode.offsetWidth);return parseInt(b)*d/100}else if(c.match(/top|bottom|height/)>0){var f=parseInt(a.elem.parentNode.offsetHeight);return parseInt(b)*f/100}else{return b}}else{return b}};return b.match(/em/)?parseInt(b,10)*a.options.em2px:parseInt(b,10)}};var o={'linear':function(b,c,a,d){return a*b/d+c},'ease-in':function(b,c,a,d){return-a*Math.cos(b/d*(Math.PI/2))+a+c},'ease-out':function(b,c,a,d){return a*Math.sin(b/d*(Math.PI/2))+c},'ease-in-out':function(b,c,a,d){return-a/2*(Math.cos(Math.PI*b/d)-1)+c}};window.Jwalk=m})();